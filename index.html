<!DOCTYPE html>

<html class="scroll-smooth" lang="pt-br">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Central de Ferramentas DP - Talentos Consultoria</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        primary: '#004aad',
                        secondary: '#196dff',
                        background: '#f1f5f9',
                        card: '#ffffff',
                    }
                }
            }
        }
    </script>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
<!-- Sistema de Autenticação -->


<style>
        .news-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
        }
        .news-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .weather-widget {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .highlight-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }
        .highlight-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }
        .alert-card { background: linear-gradient(135deg, #4285f4, #34a853); }
        .confronto-card { background: linear-gradient(135deg, #5f6368, #3c4043); }
        .futebol-card { background: linear-gradient(135deg, #34a853, #137333); }
        .politica-card { background: linear-gradient(135deg, #ea4335, #d33b2c); }
        .musica-card { background: linear-gradient(135deg, #9c27b0, #7b1fa2); }
        .arte-card { background: linear-gradient(135deg, #e91e63, #ad1457); }
        .transporte-card { background: linear-gradient(135deg, #ff9800, #e65100); }
    </style>
<style>
@keyframes scroll-x {
  0% { transform: translateX(0); }
  100% { transform: translateX(-50%); }
}
.animate-scroll-x {
  animation: scroll-x 40s linear infinite;
}
.animate-scroll-x:hover {
  animation-play-state: paused;
}
</style><style>
    .news-pill { background: #111827; color: #e5e7eb; }
    .news-pill:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,0,0,.35); }
    </style><style>html[data-auth='checking'] body{visibility:hidden}</style><script>document.documentElement.setAttribute('data-auth','checking');</script><script crossorigin="anonymous" src="https://alcdn.msauth.net/browser/2.38.2/js/msal-browser.min.js"></script><script src="msal-config.js"></script><script src="config.js"></script><script src="auth-guard.js"></script></head>
<body class="bg-background flex flex-col min-h-screen font-sans"><script data-inline-auth="1">
(function(){
  try{
    const isLogin = /login\.html$/i.test(location.pathname);
    if(!isLogin){
      const acc = localStorage.getItem('userAccount');
      if(!acc){
        // preserve original path for after-login redirect
        localStorage.setItem('redirectAfterLogin', location.pathname + location.search + location.hash);
        // Try relative login first (works in subpaths), then absolute as fallback
        const base = location.origin || (location.protocol + '//' + location.host);
        location.replace(base + '/login.html');
        return;
      }
    }
    document.documentElement.removeAttribute('data-auth');
  }catch(e){
    console.error('inline-auth error', e);
  }
})();
</script>
<header class="bg-white shadow-md p-4 sticky top-0 z-50">
<div class="container mx-auto flex justify-between items-center">
<a class="flex items-center space-x-3" href="index.html">
<div class="w-10 h-10 bg-red-600 rounded-full flex items-center justify-center">
<span class="text-white font-bold text-lg">T</span>
</div>
<span class="text-xl font-bold text-red-700 hidden md:block">Talentos Consultoria</span>
</a>
<nav class="flex items-center gap-6">
<a class="text-gray-600 hover:text-primary font-medium transition duration-300" href="https://intranet.talentosconsultoria.com.br">Wiki</a>
<a class="text-gray-600 hover:text-primary font-medium transition duration-300" href="https://aej.talentosconsultoria.com.br">AEJ</a>
<div class="relative">
<button class="text-gray-600 hover:text-primary font-medium transition duration-300 flex items-center space-x-1 focus:outline-none" id="tools-dropdown-button">
<span>Ferramentas DP</span>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M19 9l-7 7-7-7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
<div class="absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg py-2 hidden border" id="tools-dropdown-menu">
<a class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors" href="qlp-format.html">📊 QLP - Formatador de Planilhas</a>
<a class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors" href="pdf-tool.html">📄 PDF - Editor de Documentos</a>
<a class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors" href="format-bancodoc.html">🔄 Bdoc - Unificação de Dados</a>
<a class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors" href="#ultimas-noticias">📰 Notícias</a></div>
</div>
<!-- O botão de logout será adicionado automaticamente pelo auth-guard.js -->
</nav>
</div>
</header>
<main class="flex-grow p-6">
<section class="mb-6" id="faixa-noticias">
<div class="flex items-center justify-between mb-3">
<h2 class="text-xl font-bold text-gray-800">Últimas Notícias</h2>
</div>
<div class="relative">
<button aria-label="Anterior" class="absolute left-0 top-1/2 -translate-y-1/2 z-10 w-9 h-9 rounded-full bg-white border shadow hover:bg-gray-50 flex items-center justify-center z-30 pointer-events-auto" id="btn-prev">◀</button>
<button aria-label="Próximo" class="absolute right-0 top-1/2 -translate-y-1/2 z-10 w-9 h-9 rounded-full bg-white border shadow hover:bg-gray-50 flex items-center justify-center z-30 pointer-events-auto" id="btn-next">▶</button>
<div class="px-12">
<div class="flex gap-3 overflow-x-auto scroll-smooth no-scrollbar pb-2" id="news-strip"></div>
</div>
<div class="pointer-events-none absolute left-0 top-0 h-full w-10 bg-gradient-to-r from-white to-transparent"></div>
<div class="pointer-events-none absolute right-0 top-0 h-full w-10 bg-gradient-to-l from-white to-transparent"></div>
</div>
<script>
(async function () {
  const strip = document.getElementById("news-strip");
  const btnPrev = document.getElementById("btn-prev");
  const btnNext = document.getElementById("btn-next");

  // --- Fetch notícias do G1 via rss2json (sem key) ---
  async function fetchJson(url){
    try { const r = await fetch(url); return await r.json(); }
    catch(e){ const r = await fetch("https://api.allorigins.win/raw?url="+encodeURIComponent(url)); return await r.json(); }
  }
  const rssUrl = "https://g1.globo.com/dynamo/rss2.xml";
  const api = "https://api.rss2json.com/v1/api.json?rss_url=" + encodeURIComponent(rssUrl);
  const data = await fetchJson(api);

  strip.innerHTML = "";
  (data.items || []).slice(0, 18).forEach(item => {
    const a = document.createElement("a");
    a.href = item.link || "#";
    a.target = "_blank";
    a.rel = "noopener";
    a.className = "news-pill min-w-[220px] w-[220px] rounded-xl shadow transition p-2 inline-flex flex-col";
    a.innerHTML = `
      <div class="w-full h-[120px] bg-gray-800 rounded overflow-hidden">
        <img src="${(item.thumbnail||'').trim() || 'https://via.placeholder.com/220x120?text=Noticia'}" class="w-full h-full object-cover" loading="lazy" />
      </div>
      <div class="mt-2 text-sm font-semibold line-clamp-2" style="-webkit-line-clamp:2;display:-webkit-box;-webkit-box-orient:vertical;overflow:hidden;">
        ${item.title || ""}
      </div>
    `;
    strip.appendChild(a);
  });

  // --- Auto-scroll com requestAnimationFrame
  let paused = false;
  let last;
  const SPEED = 30; // px por segundo
  function tick(ts){
    if (paused) { last = ts; return requestAnimationFrame(tick); }
    if (last == null) last = ts;
    const dt = (ts - last) / 1000;
    last = ts;
    const dx = SPEED * dt;
    if (strip.scrollLeft + strip.clientWidth + 1 >= strip.scrollWidth) {
      strip.scrollTo({left: 0});
    } else {
      strip.scrollLeft += dx;
    }
    requestAnimationFrame(tick);
  }
  requestAnimationFrame(tick);

  // Pausa no hover/focus
  strip.addEventListener("mouseenter", () => paused = true);
  strip.addEventListener("mouseleave", () => paused = false);
  document.addEventListener("visibilitychange", () => { paused = document.hidden; });

  // --- Botões laterais funcionam junto com auto-scroll
  function nudge(dir){
    paused = true;
    const step = 260 * dir;
    strip.scrollBy({left: step, behavior: "smooth"});
    clearTimeout(nudge._t);
    nudge._t = setTimeout(()=> paused = false, 1200); // retoma depois de 1.2s
  }
  btnPrev.addEventListener("click", (e)=>{ e.preventDefault(); nudge(-1); });
  btnNext.addEventListener("click", (e)=>{ e.preventDefault(); nudge(1); });
})();
</script></section>
<style>
  .no-scrollbar::-webkit-scrollbar{display:none}
  .no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}
</style>
<style>
  .no-scrollbar::-webkit-scrollbar{display:none}
  .no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}
</style>
<script>
async function fetchWithProxy(url){
  try { return await (await fetch(url)).json(); }
  catch(e){ return await (await fetch("https://api.allorigins.win/raw?url="+encodeURIComponent(url))).json(); }
}
(async function () {
  // G1 RSS -> usar conversão para JSON via rss2json gratuito (sem key) usando allorigins/raw
  const rssUrl = "https://g1.globo.com/dynamo/rss2.xml";
  const rssToJson = "https://api.rss2json.com/v1/api.json?rss_url=" + encodeURIComponent(rssUrl);
  let data;
  try {
    data = await fetchWithProxy(rssToJson);
  } catch(e){ console.error(e); return; }

  const strip = document.getElementById("news-strip");
  (data.items || []).slice(0, 16).forEach(item => {
    const title = item.title || "";
    const link = item.link || "#";
    const img = (item.thumbnail || "").trim() || "https://via.placeholder.com/220x120?text=Noticia";

    const card = document.createElement("a");
    card.href = link;
    card.target = "_blank";
    card.rel = "noopener";
    card.className = "min-w-[220px] w-[220px] bg-white rounded-lg shadow hover:shadow-lg hover:-translate-y-0.5 transition p-2 inline-flex flex-col";

    card.innerHTML = `
      <div class="w-full h-[120px] bg-gray-200 rounded overflow-hidden">
        <img src="${img}" class="w-full h-full object-cover" loading="lazy" />
      </div>
      <div class="mt-2 text-sm font-semibold text-gray-800 line-clamp-2" style="-webkit-line-clamp:2;display:-webkit-box;-webkit-box-orient:vertical;overflow:hidden;">
        ${title}
      </div>
    `;
    strip.appendChild(card);
  });

  // Navegação
  const prev = document.getElementById("btn-prev");
  const next = document.getElementById("btn-next");
  const step = 240;
  prev.addEventListener("click", () => strip.scrollBy({left: -step, behavior: "smooth"}));
  next.addEventListener("click", () => strip.scrollBy({left: step, behavior: "smooth"}));
})();
</script>
<div class="container mx-auto max-w-7xl">
<div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
<!-- Coluna Principal -->
<div class="lg:col-span-3 space-y-6">
<!-- Destaques do Dia -->
<section>
<h2 class="text-2xl font-bold text-gray-800 mb-6">Destaques do Dia</h2>
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
<div class="highlight-card alert-card p-6 rounded-xl text-white" onclick="window.open('https://g1.globo.com/rj/rio-de-janeiro/', '_blank')">
<div class="text-4xl mb-3">🌊</div>
<h3 class="font-bold text-xl mb-2">Alerta</h3>
<p class="text-sm opacity-90 mb-3">Ressaca no litoral carioca com ondas de até 2,5 metros afeta praias da Zona Sul</p>
</div>
<div class="highlight-card confronto-card p-6 rounded-xl text-white" onclick="window.open('https://extra.globo.com/noticias/rio/', '_blank')">
<div class="text-4xl mb-3">⚔️</div>
<h3 class="font-bold text-xl mb-2">Confronto</h3>
<p class="text-sm opacity-90 mb-3">Operação policial no Complexo da Maré deixa moradores em alerta</p>
</div>
<div class="highlight-card futebol-card p-6 rounded-xl text-white" onclick="window.open('https://oglobo.globo.com/esportes/', '_blank')">
<div class="text-4xl mb-3">⚽</div>
<h3 class="font-bold text-xl mb-2">Futebol</h3>
<p class="text-sm opacity-90 mb-3">Palmeiras vence Botafogo por 1 a 0 no Nilton Santos pelo Brasileirão</p>
</div>
<div class="highlight-card politica-card p-6 rounded-xl text-white" onclick="window.open('https://rj.gov.br/', '_blank')">
<div class="text-4xl mb-3">🏛️</div>
<h3 class="font-bold text-xl mb-2">Política</h3>
<p class="text-sm opacity-90 mb-3">Governo do RJ anuncia novos investimentos em segurança pública</p>
</div>
</div>
</section>
<!-- Mais Notícias -->
<section>
<h2 class="text-2xl font-bold text-gray-800 mb-6">Mais Notícias</h2>
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
<div class="highlight-card musica-card p-6 rounded-xl text-white" onclick="window.open('https://g1.globo.com/rj/rio-de-janeiro/musica/', '_blank')">
<div class="text-4xl mb-3">🎵</div>
<h3 class="font-bold text-xl mb-2">Música</h3>
<p class="text-sm opacity-90">Eventos musicais e shows no Rio de Janeiro</p>
</div>
<div class="highlight-card arte-card p-6 rounded-xl text-white" onclick="window.open('https://oglobo.globo.com/cultura/', '_blank')">
<div class="text-4xl mb-3">🎨</div>
<h3 class="font-bold text-xl mb-2">Arte</h3>
<p class="text-sm opacity-90">Exposições e eventos culturais na cidade</p>
</div>
<div class="highlight-card transporte-card p-6 rounded-xl text-white" onclick="window.open('https://www.rio.rj.gov.br/web/smtr', '_blank')">
<div class="text-4xl mb-3">🚌</div>
<h3 class="font-bold text-xl mb-2">Transporte</h3>
<p class="text-sm opacity-90">Informações sobre mobilidade urbana no Rio</p>
</div>
</div>
</section>
</div>
<!-- Barra Lateral -->
<div class="lg:col-span-1 space-y-6">
<!-- Widget do Clima -->
<div class="weather-widget text-white rounded-2xl shadow-xl p-6">
<div class="flex items-center justify-between mb-4">
<div>
<h3 class="font-bold text-lg" id="wx-city">Rio de Janeiro</h3>
<p class="text-sm opacity-90" id="wx-desc">Carregando...</p>
</div>
<div class="text-right">
<div class="text-3xl font-bold" id="wx-temp">--°C</div>
<div class="text-2xl" id="wx-icon">⛅</div>
</div>
</div>
<div class="grid grid-cols-5 gap-2 text-center" id="wx-daily"></div>
<script>
// Open-Meteo Rio de Janeiro com painel de 15 dias (toggle)
async function loadWeather(){
  const url = "https://api.open-meteo.com/v1/forecast?latitude=-22.9068&longitude=-43.1729&timezone=America%2FSao_Paulo&current_weather=true&daily=temperature_2m_max,temperature_2m_min,weather_code&forecast_days=16";
  const res = await fetch(url);
  const data = await res.json();
  const current = data.current_weather || {};
  const daily = data.daily || {};
  document.getElementById('wx-temp').textContent = Math.round(current.temperature) + "°C";
  document.getElementById('wx-desc').textContent = codeToText(current.weathercode);

  const cont = document.getElementById('wx-daily');
  cont.innerHTML = "";
  const dates = daily.time || [];
  for(let i=1;i<Math.min(6, dates.length);i++){
    cont.appendChild(dayCell(dates[i], daily.weather_code[i], daily.temperature_2m_min[i], daily.temperature_2m_max[i]));
  }

  // painel estendido
  const ext = document.createElement('div');
  ext.id = "wx-extended";
  ext.className = "grid grid-cols-5 gap-2 text-center mt-2 hidden";
  for(let i=6;i<Math.min(16, dates.length);i++){
    ext.appendChild(dayCell(dates[i], daily.weather_code[i], daily.temperature_2m_min[i], daily.temperature_2m_max[i]));
  }
  cont.parentElement.appendChild(ext);

  // botão toggle
  const btn = document.createElement('button');
  btn.id = "wx-toggle";
  btn.className = "mt-3 text-xs bg-white/20 hover:bg-white/30 transition rounded px-3 py-1";
  btn.textContent = "Ver 15 dias";
  btn.addEventListener('click', ()=>{
    const h = ext.classList.toggle('hidden');
    btn.textContent = h ? "Ver 15 dias" : "Ocultar";
  });
  cont.parentElement.appendChild(btn);
}
function dayCell(dateStr, code, min, max){
  const el = document.createElement('div');
  const d = new Date(dateStr + "T00:00:00");
  el.className = "bg-white/10 rounded p-2";
  el.innerHTML = `
    <div class="text-xs">${d.toLocaleDateString('pt-BR', {weekday:'short'})}</div>
    <div class="text-lg">${codeToIcon(code)}</div>
    <div class="text-xs">${Math.round(min)}° / ${Math.round(max)}°</div>
  `;
  return el;
}
function codeToText(code){
  const map = {0:"Céu limpo",1:"Predomínio de sol",2:"Parcialmente nublado",3:"Nublado",45:"Nevoeiro",48:"Nevoeiro",
               51:"Garoa fraca",53:"Garoa",55:"Garoa forte",61:"Chuva fraca",63:"Chuva",65:"Chuva forte",71:"Neve",
               80:"Pancadas",95:"Tempestade"};
  return map[code] || "Tempo";
}
function codeToIcon(code){
  if(code===0) return "☀️";
  if([1,2].includes(code)) return "🌤️";
  if(code===3) return "☁️";
  if([61,63,65,80].includes(code)) return "🌧️";
  if([95].includes(code)) return "⛈️";
  return "⛅";
}
loadWeather();
</script></div>
<!-- Copa Libertadores -->
<div class="bg-white rounded-2xl shadow-xl p-6">
<div class="flex items-center mb-4">
<div class="w-8 h-8 bg-green-600 rounded-full flex items-center justify-center mr-3">
<span class="text-white text-xs font-bold">⚽</span>
</div>
<h3 class="font-bold text-lg text-gray-800">Futebol - ESPN (Série A)</h3>
</div>
<p class="text-sm text-gray-600 mb-4">Jogos de hoje e ao vivo</p>
<div class="space-y-3" id="espn-list"></div>
<script>
async function fetchJson(url){
  try { return await (await fetch(url)).json(); }
  catch(e){ return await (await fetch('https://api.allorigins.win/raw?url='+encodeURIComponent(url))).json(); }
}
function timeBR(iso){
  try{ const d=new Date(iso); return d.toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'}); }catch{ return ''; }
}
function statusText(c){
  const st = c.status?.type?.state; // 'pre' | 'in' | 'post'
  const short = c.status?.type?.shortDetail || '';
  const detail = c.status?.type?.detail || '';
  if(st==='pre') return timeBR(c.startDate || c.date) || short || 'Agendado';
  if(st==='in')  return 'AO VIVO ' + (short || detail || '');
  if(st==='post')return short || 'Final';
  return short || '';
}
async function carregarESPN(){
  const url = 'https://site.api.espn.com/apis/site/v2/sports/soccer/bra.1/scoreboard';
  const data = await fetchJson(url);
  const list = document.getElementById('espn-list');
  list.innerHTML = '';
  const events = (data.events || []);
  if(!events.length){ list.innerHTML = '<div class="text-sm text-gray-500">Sem jogos listados neste momento.</div>'; return; }

  events.slice(0,10).forEach(ev => {
    const comp = (ev.competitions && ev.competitions[0]) || {};
    const teams = (comp.competitors || []).sort((a,b)=> (a.home? -1: 1));
    const home = teams[0] || {};
    const away = teams[1] || {};
    const st = comp.status?.type?.state;
    const showScore = (st==='in' || st==='post');

    const row = document.createElement('div');
    row.className = 'bg-gray-50 rounded-lg p-3 grid grid-cols-[1fr_auto_1fr] items-center gap-2';

    row.innerHTML = `
      <div class="flex items-center gap-2 truncate">
        <img src="${home.team?.logo || ''}" class="w-6 h-6 rounded-full" alt=""/>
        <span class="font-semibold text-sm truncate">${home.team?.shortDisplayName || home.team?.name || 'Casa'}</span>
      </div>
      <div class="text-center">
        <div class="text-gray-800 text-sm font-bold">${showScore ? (home.score || '0') + ' : ' + (away.score || '0') : timeBR(ev.date) || '-'}</div>
        <div class="text-[10px] text-gray-500">${statusText(comp)}</div>
      </div>
      <div class="flex items-center gap-2 justify-end truncate">
        <span class="font-semibold text-sm truncate">${away.team?.shortDisplayName || away.team?.name || 'Fora'}</span>
        <img src="${away.team?.logo || ''}" class="w-6 h-6 rounded-full" alt=""/>
      </div>
    `;
    list.appendChild(row);
  });
}
carregarESPN();
setInterval(carregarESPN, 60000);
</script>
</div>
</div>
</div>
</div>
<script>
async function carregarNoticiasG1() {
  const rssUrl = "https://g1.globo.com/dynamo/rss2.xml";
  const response = await fetch("https://api.allorigins.win/get?url=" + encodeURIComponent(rssUrl));
  const data = await response.json();
  const parser = new DOMParser();
  const xml = parser.parseFromString(data.contents, "text/xml");
  const items = xml.querySelectorAll("item");
  const carousel = document.getElementById("g1-carousel");
  
  items.forEach((item, index) => {
    if (index >= 5) return;
    const title = item.querySelector("title").textContent;
    const link = item.querySelector("link").textContent;
    const description = item.querySelector("description").textContent;

    // Extrair imagem do <description> com regex
    const imgMatch = description.match(/<img.*?src="(.*?)"/);
    const imgSrc = imgMatch ? imgMatch[1] : "https://via.placeholder.com/600x300?text=Notícia";

    const li = document.createElement("li");
    li.className = "inline-block w-96 h-56 relative flex-shrink-0";
    li.innerHTML = `
      <a href="${link}" target="_blank" class="block w-full h-full">
        <img src="${imgSrc}" class="w-full h-full object-cover rounded-xl" />
        <div class="absolute bottom-0 bg-black bg-opacity-50 text-white w-full text-sm px-4 py-2 rounded-b-xl">
          ${title}
        </div>
      </a>
    `;
    carousel.appendChild(li);
  });
}
carregarNoticiasG1();
</script>
<!-- Faixa de Notícias (estilo Bing) -->
<style>
  .no-scrollbar::-webkit-scrollbar{display:none}
  .no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}
</style>
<script>
(async function () {
  const rssUrl = "https://g1.globo.com/dynamo/rss2.xml";
  const proxy = "https://api.allorigins.win/get?url=" + encodeURIComponent(rssUrl);

  const res = await fetch(proxy);
  const data = await res.json();
  const xml = new DOMParser().parseFromString(data.contents, "text/xml");
  const items = Array.from(xml.querySelectorAll("item")).slice(0, 14);

  const strip = document.getElementById("news-strip");

  items.forEach(it => {
    const title = it.querySelector("title")?.textContent || "";
    const link = it.querySelector("link")?.textContent || "#";
    const desc = it.querySelector("description")?.textContent || "";
    const imgMatch = desc.match(/<img.*?src="(.*?)"/i);
    const img = imgMatch ? imgMatch[1] : "https://via.placeholder.com/160x90?text=Noticia";

    const card = document.createElement("a");
    card.href = link;
    card.target = "_blank";
    card.rel = "noopener";
    card.className = "min-w-[220px] w-[220px] bg-white rounded-lg shadow hover:shadow-lg hover:-translate-y-0.5 transition p-2 inline-flex flex-col";

    card.innerHTML = `
      <div class="w-full h-[120px] bg-gray-200 rounded overflow-hidden">
        <img src="${img}" class="w-full h-full object-cover" loading="lazy" />
      </div>
      <div class="mt-2 text-sm font-semibold text-gray-800 line-clamp-2" style="-webkit-line-clamp:2;display:-webkit-box;-webkit-box-orient:vertical;overflow:hidden;">
        ${title}
      </div>
    `;
    strip.appendChild(card);
  });

  // Navegação por botões
  const prev = document.getElementById("btn-prev");
  const next = document.getElementById("btn-next");
  const step = 240; // px por clique
  prev.addEventListener("click", () => strip.scrollBy({left: -step, behavior: "smooth"}));
  next.addEventListener("click", () => strip.scrollBy({left: step, behavior: "smooth"}));

  // Arrastar para rolar (drag scroll)
  let isDown = false, startX = 0, scrollLeft = 0;
  strip.addEventListener("mousedown", (e) => { isDown = true; startX = e.pageX - strip.offsetLeft; scrollLeft = strip.scrollLeft; strip.classList.add("cursor-grabbing"); });
  strip.addEventListener("mouseleave", () => { isDown = false; strip.classList.remove("cursor-grabbing"); });
  strip.addEventListener("mouseup", () => { isDown = false; strip.classList.remove("cursor-grabbing"); });
  strip.addEventListener("mousemove", (e) => {
    if(!isDown) return;
    const x = e.pageX - strip.offsetLeft;
    const walk = (x - startX) * 1;
    strip.scrollLeft = scrollLeft - walk;
  });
})();
</script>
</main>
<footer class="bg-gray-800 text-white text-center p-6">
<div class="container mx-auto flex flex-col sm:flex-row justify-between items-center gap-6">
<p class="text-gray-400 text-sm">© 2025 Talentos Consultoria. Todos os direitos reservados.</p>
<div class="flex items-center gap-6">
<a class="text-gray-400 hover:text-white transition-colors" href="https://talentosconsultoria.com.br/" rel="noopener noreferrer" target="_blank" title="Nosso Site">
<svg class="w-6 h-6" fill="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"></path></svg>
</a>
<a class="text-gray-400 hover:text-white transition-colors" href="https://www.instagram.com/talentosconsultoria/" rel="noopener noreferrer" target="_blank" title="Nosso Instagram">
<svg class="w-6 h-6" fill="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.28.058 1.688.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.689-.073-4.948-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.162 6.162 6.162 6.162-2.759 6.162-6.162-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4s1.791-4 4-4 4 1.78 4 4-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path></svg>
</a>
<a class="text-gray-400 hover:text-white transition-colors" href="https://www.linkedin.com/company/talentos-consultoria/" rel="noopener noreferrer" target="_blank" title="Nosso LinkedIn">
<svg class="w-6 h-6" fill="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path></svg>
</a>
</div>
</div>
</footer>
<script>
        // Script para o dropdown do cabeçalho
        const dropdownButton = document.getElementById('tools-dropdown-button');
        const dropdownMenu = document.getElementById('tools-dropdown-menu');
        
        if (dropdownButton && dropdownMenu) {
            dropdownButton.addEventListener('click', (event) => {
                event.stopPropagation();
                dropdownMenu.classList.toggle('hidden');
            });
            
            // Fechar dropdown ao clicar fora
            document.addEventListener('click', (event) => {
                if (!dropdownButton.contains(event.target) && !dropdownMenu.contains(event.target)) {
                    dropdownMenu.classList.add('hidden');
                }
            });
        }
    </script>
</body>
</html>